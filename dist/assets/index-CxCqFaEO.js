import{r as R,R as It}from"./index--NVultsq.js";import{s as le}from"./index-CWBrEpP-.js";const Kt=0,Gt=1,Yt=2,Ut=3;var qt=Object.prototype.hasOwnProperty;function Ot(t,e){var n,o;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((o=t.length)===e.length)for(;o--&&Ot(t[o],e[o]););return o===-1}if(!n||typeof t=="object"){o=0;for(n in t)if(qt.call(t,n)&&++o&&!qt.call(e,n)||!(n in e)||!Ot(t[n],e[n]))return!1;return Object.keys(e).length===o}}return t!==t&&e!==e}const x=new WeakMap,$=()=>{},D=$(),ct=Object,u=t=>t===D,I=t=>typeof t=="function",W=(t,e)=>({...t,...e}),Xt=t=>I(t.then),Et={},st={},Lt="undefined",Z=typeof window!=Lt,St=typeof document!=Lt,fe=Z&&"Deno"in window,de=()=>Z&&typeof window.requestAnimationFrame!=Lt,Qt=(t,e)=>{const n=x.get(t);return[()=>!u(e)&&t.get(e)||Et,o=>{if(!u(e)){const r=t.get(e);e in st||(st[e]=r),n[5](e,W(r,o),r||Et)}},n[6],()=>!u(e)&&e in st?st[e]:!u(e)&&t.get(e)||Et]};let vt=!0;const pe=()=>vt,[Dt,Tt]=Z&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[$,$],Ee=()=>{const t=St&&document.visibilityState;return u(t)||t!=="hidden"},Re=t=>(St&&document.addEventListener("visibilitychange",t),Dt("focus",t),()=>{St&&document.removeEventListener("visibilitychange",t),Tt("focus",t)}),he=t=>{const e=()=>{vt=!0,t()},n=()=>{vt=!1};return Dt("online",e),Dt("offline",n),()=>{Tt("online",e),Tt("offline",n)}},me={isOnline:pe,isVisible:Ee},ge={initFocus:Re,initReconnect:he},Ht=!It.useId,Q=!Z||fe,we=t=>de()?window.requestAnimationFrame(t):setTimeout(t,1),it=Q?R.useEffect:R.useLayoutEffect,Rt=typeof navigator<"u"&&navigator.connection,zt=!Q&&Rt&&(["slow-2g","2g"].includes(Rt.effectiveType)||Rt.saveData),ot=new WeakMap,Oe=t=>ct.prototype.toString.call(t),ht=(t,e)=>t===`[object ${e}]`;let Se=0;const _t=t=>{const e=typeof t,n=Oe(t),o=ht(n,"Date"),r=ht(n,"RegExp"),a=ht(n,"Object");let s,i;if(ct(t)===t&&!o&&!r){if(s=ot.get(t),s)return s;if(s=++Se+"~",ot.set(t,s),Array.isArray(t)){for(s="@",i=0;i<t.length;i++)s+=_t(t[i])+",";ot.set(t,s)}if(a){s="#";const l=ct.keys(t).sort();for(;!u(i=l.pop());)u(t[i])||(s+=i+":"+_t(t[i])+",");ot.set(t,s)}}else s=o?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},at=t=>{if(I(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?_t(t):"",[t,e]};let ve=0;const Ct=()=>++ve;async function Zt(...t){const[e,n,o,r]=t,a=W({populateCache:!0,throwOnError:!0},typeof r=="boolean"?{revalidate:r}:r||{});let s=a.populateCache;const i=a.rollbackOnError;let l=a.optimisticData;const b=T=>typeof i=="function"?i(T):i!==!1,O=a.throwOnError;if(I(n)){const T=n,h=[],L=e.keys();for(const m of L)!/^\$(inf|sub)\$/.test(m)&&T(e.get(m)._k)&&h.push(m);return Promise.all(h.map(g))}return g(n);async function g(T){const[h]=at(T);if(!h)return;const[L,m]=Qt(e,h),[lt,c,k,G]=x.get(e),M=()=>{const _=lt[h];return(I(a.revalidate)?a.revalidate(L().data,T):a.revalidate!==!1)&&(delete k[h],delete G[h],_&&_[0])?_[0](Yt).then(()=>L().data):L().data};if(t.length<3)return M();let S=o,F,N=!1;const p=Ct();c[h]=[p,0];const H=!u(l),V=L(),z=V.data,tt=V._c,U=u(tt)?z:tt;if(H&&(l=I(l)?l(U,z):l,m({data:l,_c:U})),I(S))try{S=S(U)}catch(_){F=_,N=!0}if(S&&Xt(S))if(S=await S.catch(_=>{F=_,N=!0}),p!==c[h][0]){if(N)throw F;return S}else N&&H&&b(F)&&(s=!0,m({data:U,_c:D}));if(s&&!N)if(I(s)){const _=s(S,U);m({data:_,error:D,_c:D})}else m({data:S,error:D,_c:D});if(c[h][1]=Ct(),Promise.resolve(M()).then(()=>{m({_c:D})}),N){if(O)throw F;return}return S}}const Jt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},kt=(t,e)=>{if(!x.has(t)){const n=W(ge,e),o=Object.create(null),r=Zt.bind(D,t);let a=$;const s=Object.create(null),i=(O,g)=>{const T=s[O]||[];return s[O]=T,T.push(g),()=>T.splice(T.indexOf(g),1)},l=(O,g,T)=>{t.set(O,g);const h=s[O];if(h)for(const L of h)L(g,T)},b=()=>{if(!x.has(t)&&(x.set(t,[o,Object.create(null),Object.create(null),Object.create(null),r,l,i]),!Q)){const O=n.initFocus(setTimeout.bind(D,Jt.bind(D,o,Kt))),g=n.initReconnect(setTimeout.bind(D,Jt.bind(D,o,Gt)));a=()=>{O&&O(),g&&g(),x.delete(t)}}};return b(),[t,r,b,a]}return[t,x.get(t)[4]]},De=(t,e,n,o,r)=>{const a=n.errorRetryCount,s=r.retryCount,i=~~((Math.random()+.5)*(1<<(s<8?s:8)))*n.errorRetryInterval;!u(a)&&s>a||setTimeout(o,i,r)},Te=Ot,[ut,te]=kt(new Map),ee=W({onLoadingSlow:$,onSuccess:$,onError:$,onErrorRetry:De,onDiscarded:$,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:zt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:zt?5e3:3e3,compare:Te,isPaused:()=>!1,cache:ut,mutate:te,fallback:{}},me),ne=(t,e)=>{const n=W(t,e);if(e){const{use:o,fallback:r}=t,{use:a,fallback:s}=e;o&&a&&(n.use=o.concat(a)),r&&s&&(n.fallback=W(r,s))}return n},yt=R.createContext({}),_e=t=>{const{value:e}=t,n=R.useContext(yt),o=I(e),r=R.useMemo(()=>o?e(n):e,[o,n,e]),a=R.useMemo(()=>o?r:ne(n,r),[o,n,r]),s=r&&r.provider,i=R.useRef(D);s&&!i.current&&(i.current=kt(s(a.cache||ut),r));const l=i.current;return l&&(a.cache=l[0],a.mutate=l[1]),it(()=>{if(l)return l[2]&&l[2](),l[3]},[]),R.createElement(yt.Provider,W(t,{value:a}))},Ce="$inf$",se=Z&&window.__SWR_DEVTOOLS_USE__,ye=se?window.__SWR_DEVTOOLS_USE__:[],be=()=>{se&&(window.__SWR_DEVTOOLS_REACT__=It)},oe=t=>I(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],re=()=>W(ee,R.useContext(yt)),Ae=(t,e)=>{const[n,o]=at(t),[,,,r]=x.get(ut);if(r[n])return r[n];const a=e(o);return r[n]=a,a},Ie=t=>(e,n,o)=>t(e,n&&((...a)=>{const[s]=at(e),[,,,i]=x.get(ut);if(s.startsWith(Ce))return n(...a);const l=i[s];return u(l)?n(...a):(delete i[s],l)}),o),Le=ye.concat(Ie),Ne=t=>function(...n){const o=re(),[r,a,s]=oe(n),i=ne(o,s);let l=t;const{use:b}=i,O=(b||[]).concat(Le);for(let g=O.length;g--;)l=O[g](l);return l(r,a||i.fetcher||null,i)},Ve=(t,e,n)=>{const o=e[t]||(e[t]=[]);return o.push(n),()=>{const r=o.indexOf(n);r>=0&&(o[r]=o[o.length-1],o.pop())}},Ke=(t,e)=>(...n)=>{const[o,r,a]=oe(n),s=(a.use||[]).concat(e);return t(o,r,{...a,use:s})};be();const xe=()=>{},Fe=xe(),bt=Object,Bt=t=>t===Fe,je=t=>typeof t=="function",rt=new WeakMap,Pe=t=>bt.prototype.toString.call(t),mt=(t,e)=>t===`[object ${e}]`;let We=0;const At=t=>{const e=typeof t,n=Pe(t),o=mt(n,"Date"),r=mt(n,"RegExp"),a=mt(n,"Object");let s,i;if(bt(t)===t&&!o&&!r){if(s=rt.get(t),s)return s;if(s=++We+"~",rt.set(t,s),Array.isArray(t)){for(s="@",i=0;i<t.length;i++)s+=At(t[i])+",";rt.set(t,s)}if(a){s="#";const l=bt.keys(t).sort();for(;!Bt(i=l.pop());)Bt(t[i])||(s+=i+":"+At(t[i])+",");rt.set(t,s)}}else s=o?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},Me=t=>{if(je(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?At(t):"",[t,e]},$e=t=>Me(t)[0],gt=It.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),wt={dedupe:!0},Ue=(t,e,n)=>{const{cache:o,compare:r,suspense:a,fallbackData:s,revalidateOnMount:i,revalidateIfStale:l,refreshInterval:b,refreshWhenHidden:O,refreshWhenOffline:g,keepPreviousData:T}=n,[h,L,m,lt]=x.get(o),[c,k]=at(t),G=R.useRef(!1),M=R.useRef(!1),S=R.useRef(c),F=R.useRef(e),N=R.useRef(n),p=()=>N.current,H=()=>p().isVisible()&&p().isOnline(),[V,z,tt,U]=Qt(o,c),_=R.useRef({}).current,Y=u(s)?u(n.fallback)?D:n.fallback[c]:s,Nt=(d,f)=>{for(const v in _){const E=v;if(E==="data"){if(!r(d[E],f[E])&&(!u(d[E])||!r(nt,f[E])))return!1}else if(f[E]!==d[E])return!1}return!0},Vt=R.useMemo(()=>{const d=!c||!e?!1:u(i)?p().isPaused()||a?!1:l!==!1:i,f=C=>{const j=W(C);return delete j._k,d?{isValidating:!0,isLoading:!0,...j}:j},v=V(),E=U(),A=f(v),K=v===E?A:f(E);let w=A;return[()=>{const C=f(V());return Nt(C,w)?(w.data=C.data,w.isLoading=C.isLoading,w.isValidating=C.isValidating,w.error=C.error,w):(w=C,C)},()=>K]},[o,c]),J=le.useSyncExternalStore(R.useCallback(d=>tt(c,(f,v)=>{Nt(v,f)||d()}),[o,c]),Vt[0],Vt[1]),xt=!G.current,ie=h[c]&&h[c].length>0,B=J.data,q=u(B)?Y&&Xt(Y)?gt(Y):Y:B,et=J.error,ft=R.useRef(q),nt=T?u(B)?u(ft.current)?q:ft.current:B:q,Ft=ie&&!u(et)?!1:xt&&!u(i)?i:p().isPaused()?!1:a?u(q)?!1:l:u(q)||l,jt=!!(c&&e&&xt&&Ft),ce=u(J.isValidating)?jt:J.isValidating,ae=u(J.isLoading)?jt:J.isLoading,X=R.useCallback(async d=>{const f=F.current;if(!c||!f||M.current||p().isPaused())return!1;let v,E,A=!0;const K=d||{},w=!m[c]||!K.dedupe,C=()=>Ht?!M.current&&c===S.current&&G.current:c===S.current,j={isValidating:!1,isLoading:!1},Wt=()=>{z(j)},Mt=()=>{const y=m[c];y&&y[1]===E&&delete m[c]},$t={isValidating:!0};u(V().data)&&($t.isLoading=!0);try{if(w&&(z($t),n.loadingTimeout&&u(V().data)&&setTimeout(()=>{A&&C()&&p().onLoadingSlow(c,n)},n.loadingTimeout),m[c]=[f(k),Ct()]),[v,E]=m[c],v=await v,w&&setTimeout(Mt,n.dedupingInterval),!m[c]||m[c][1]!==E)return w&&C()&&p().onDiscarded(c),!1;j.error=D;const y=L[c];if(!u(y)&&(E<=y[0]||E<=y[1]||y[1]===0))return Wt(),w&&C()&&p().onDiscarded(c),!1;const P=V().data;j.data=r(P,v)?P:v,w&&C()&&p().onSuccess(v,c,n)}catch(y){Mt();const P=p(),{shouldRetryOnError:dt}=P;P.isPaused()||(j.error=y,w&&C()&&(P.onError(y,c,P),(dt===!0||I(dt)&&dt(y))&&(!p().revalidateOnFocus||!p().revalidateOnReconnect||H())&&P.onErrorRetry(y,c,P,ue=>{const pt=h[c];pt&&pt[0]&&pt[0](Ut,ue)},{retryCount:(K.retryCount||0)+1,dedupe:!0})))}return A=!1,Wt(),!0},[c,o]),Pt=R.useCallback((...d)=>Zt(o,S.current,...d),[]);if(it(()=>{F.current=e,N.current=n,u(B)||(ft.current=B)}),it(()=>{if(!c)return;const d=X.bind(D,wt);let f=0;p().revalidateOnFocus&&(f=Date.now()+p().focusThrottleInterval);const E=Ve(c,h,(A,K={})=>{if(A==Kt){const w=Date.now();p().revalidateOnFocus&&w>f&&H()&&(f=w+p().focusThrottleInterval,d())}else if(A==Gt)p().revalidateOnReconnect&&H()&&d();else{if(A==Yt)return X();if(A==Ut)return X(K)}});return M.current=!1,S.current=c,G.current=!0,z({_k:k}),Ft&&(m[c]||(u(q)||Q?d():we(d))),()=>{M.current=!0,E()}},[c]),it(()=>{let d;function f(){const E=I(b)?b(V().data):b;E&&d!==-1&&(d=setTimeout(v,E))}function v(){!V().error&&(O||p().isVisible())&&(g||p().isOnline())?X(wt).then(f):f()}return f(),()=>{d&&(clearTimeout(d),d=-1)}},[b,O,g,c]),R.useDebugValue(nt),a&&u(q)&&c){if(!Ht&&Q)throw new Error("Fallback data is required when using Suspense in SSR.");F.current=e,N.current=n,M.current=!1;const d=lt[c];if(!u(d)){const f=Pt(d);gt(f)}if(u(et)){const f=X(wt);u(nt)||(f.status="fulfilled",f.value=!0),gt(f)}else throw et}return{mutate:Pt,get data(){return _.data=!0,nt},get error(){return _.error=!0,et},get isValidating(){return _.isValidating=!0,ce},get isLoading(){return _.isLoading=!0,ae}}},qe=ct.defineProperty(_e,"defaultValue",{value:ee}),He=Ne(Ue),Ge=Object.freeze(Object.defineProperty({__proto__:null,SWRConfig:qe,default:He,mutate:te,preload:Ae,unstable_serialize:$e,useSWRConfig:re},Symbol.toStringTag,{value:"Module"}));export{Ce as I,x as S,D as U,Qt as a,it as b,ut as c,I as d,Ge as e,u as i,at as s,He as u,Ke as w};
